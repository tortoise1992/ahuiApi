{"version":3,"sources":["common/components/TableToExcel/index.js","pages/others/mainCard/ExampleTablesDL.js"],"names":["TableToExcel","props","_this","Object","D_sunmnet_react_bigdata_template_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","this","D_sunmnet_react_bigdata_template_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__","D_sunmnet_react_bigdata_template_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__","call","base64","s","window","btoa","unescape","encodeURIComponent","format","c","replace","m","p","handleDownload","document","table","console","error","getElementById","nodeType","nodeName","outerHTML","sheet","String","filename","concat","context","worksheet","element","createElement","href","download","body","appendChild","click","removeChild","bind","D_sunmnet_react_bigdata_template_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_7__","content","react__WEBPACK_IMPORTED_MODULE_8___default","a","onClick","antd_lib_button__WEBPACK_IMPORTED_MODULE_1___default","id","className","buttonText","Fragment","Component","columns","title","dataIndex","children","ExampleTablesDL","data","i","push","key","college","2016","2017","2018","tableData","typeName","react__WEBPACK_IMPORTED_MODULE_11___default","antd_lib_card__WEBPACK_IMPORTED_MODULE_1___default","style","extra","_common_components_TableToExcel__WEBPACK_IMPORTED_MODULE_12__","antd_lib_button__WEBPACK_IMPORTED_MODULE_5___default","icon","map","item","index","width","antd_lib_table__WEBPACK_IMPORTED_MODULE_3___default","dataSource","pagination"],"mappings":"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","file":"static/js/30.9d1ba55b.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport { Button } from 'antd'\r\n\r\nclass TableToExcel extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.handleDownload = this.handleDownload.bind(this);\r\n    }\r\n\r\n    base64 = (s) => {\r\n        return window.btoa(unescape(encodeURIComponent(s)));\r\n    }\r\n\r\n    format = (s, c) => {\r\n        return s.replace(/{(\\w+)}/g, (m, p) => c[p]);\r\n    }\r\n\r\n    handleDownload = ()=> {\r\n        if (!document) {\r\n            if (process.env.NODE_ENV !== 'production') {\r\n                console.error('Failed to access document object');\r\n            }\r\n            return null;\r\n        }\r\n        if(!this.props.table){\r\n            console.error('需传入table参数，参数为table的id！');\r\n            return null;\r\n        }\r\n        if (document.getElementById(this.props.table).nodeType !== 1 || document.getElementById(this.props.table).nodeName !== 'TABLE') {\r\n            if (process.env.NODE_ENV !== 'production') {\r\n                console.error('Provided table property is not html table element');\r\n            }\r\n\r\n            return null;\r\n        }\r\n        const table = document.getElementById(this.props.table).outerHTML;\r\n        const sheet = String(this.props.sheet);\r\n        const filename = `${String(this.props.filename)}.xls`;\r\n\r\n        const uri = 'data:application/vnd.ms-excel;base64,';\r\n        const template =\r\n            '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-mic' +\r\n            'rosoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta cha' +\r\n            'rset=\"UTF-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:Exce' +\r\n            'lWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/>' +\r\n            '</x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></' +\r\n            'xml><![endif]--></head><body>{table}</body></html>';\r\n\r\n        const context = {\r\n            worksheet: sheet || 'Worksheet',\r\n            table,\r\n        };\r\n\r\n        const element = window.document.createElement('a');\r\n        element.href =\r\n            uri +\r\n            this.base64(\r\n                this.format(template, context),\r\n            );\r\n        element.download = filename;\r\n        document.body.appendChild(element);\r\n        element.click();\r\n        document.body.removeChild(element);\r\n\r\n        return true;\r\n    }\r\n    render() {\r\n        const content = this.props.content?(\r\n            <span onClick={this.handleDownload}>{this.props.content}</span>\r\n        ):(\r\n            <Button\r\n                id={this.props.id}\r\n                className={this.props.className}\r\n                onClick={this.handleDownload}\r\n            >\r\n                {this.props.buttonText}\r\n            </Button>\r\n        )\r\n        return (\r\n            <React.Fragment>{content}</React.Fragment>\r\n        );\r\n    }\r\n}\r\n\r\nexport default TableToExcel;","import React, { Component } from 'react';\r\nimport { Card, Table, Button } from 'antd';\r\nimport ReactHTMLTableToExcel from '../../../common/components/TableToExcel';\r\nimport './style.less'\r\n\r\nconst columns = [{\r\n    title: '院系',\r\n    dataIndex: 'college'\r\n  }, {\r\n    title: '年级',\r\n    children: [{\r\n        title: '2016',\r\n        dataIndex: '2016',\r\n    }, {\r\n        title: '2017',\r\n        dataIndex: '2017',\r\n    }, {\r\n        title: '2018',\r\n        dataIndex: '2018',\r\n    }],\r\n  }];\r\n\r\nclass ExampleTablesDL extends Component {\r\n    render() {\r\n        const data = [];\r\n        for (let i = 0; i < 5; i++) {\r\n            data.push({\r\n                key: i,\r\n                college: '计算机学院',\r\n                '2016': i + 1,\r\n                '2017': i + 2,\r\n                '2018': i + 3,\r\n            });\r\n        }\r\n        const tableData = [{\r\n            typeName: '高校专项',\r\n            data: data\r\n        },{\r\n            typeName: '国家专项',\r\n            data: data\r\n        }]\r\n        return (\r\n            <Card\r\n                className=\"example-tables-dl\"\r\n                style={this.props.style}\r\n                title={'复杂table转excel'}\r\n                extra={<ReactHTMLTableToExcel\r\n                    table=\"table-to-xls2\"\r\n                    filename=\"excel下载\"\r\n                    content={<Button icon={\"download\"} />} />}\r\n            >\r\n                <table id=\"table-to-xls2\" className=\"border-table table-center\">\r\n                    <tbody>\r\n                        {tableData.map((item,index)=>(\r\n                            <tr key={index}>\r\n                                <td style={{width: 150}}>\r\n                                    {item.typeName}\r\n                                </td>\r\n                                <td className=\"border-bottom-none\">\r\n                                    <Table columns={columns} dataSource={item.data} pagination={false} />\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n                \r\n            </Card>\r\n        )\r\n    }\r\n}\r\n\r\nexport default ExampleTablesDL;"],"sourceRoot":""}